# ORBSLAM2中ORB特征的提取
## 提取器参数设置
1. 图像金字塔每层提取的特征点数量与尺寸比例一致，是一个等比数列，这个等比数列和为提取器的参数nfeatures(提取的特征点数量)

## 提取操作步骤总结
1. 构建图像金字塔；(cv::resize线性插值);
2. 将每层金字塔划分成**大约**`30*30`大小的网格；
3. 最多使用两种阈值分别在每个网格上尽可能提取到fast特征点（使用`cv::FAST`），将提取到的特征点存储到当前层的特征点集合中;
4. 将上面提取到的当前层的特征点进行四叉树存储，四叉树会一直划分下去，直到:
        1. 当前平面节点的数量达到需要提取的特征点数量了
        2. 每个四叉树节点都只有一个特征点
5. 四叉树停止划分后，保留每个节点下最好的特征点（harris响应值最大）,这样会使得提取到的特征点尽量不要挤在一起。
6. 计算本层特征点的方向，使用灰度质心法
7. 分层逐层计算特征点的描述子
        - 这一步需要说一下的是代码中`std::vector<cv::Point> pattern`会存入ORB论文中启发式搜索算法计算得到的256对匹配点对
        - 为了保证旋转不变性，会将匹配对坐标按照特征点的方向角度进行旋转，然后根据旋转结果在图像中得到灰度值并做比较
8. 规范关键点坐标，将各个尺度平面上的关键点坐标规范到基平面上

## 总结
1. fast关键点的提取直接使用`cv::FAST`函数
2. 将每个平面分成很多`30*30`网格进行分别提取，设置两种阈值，使得每个区域都尽可能提取到关键点
3. 因为提取到的关键点很容易出现扎堆现象，使用平面四叉树结构避免

